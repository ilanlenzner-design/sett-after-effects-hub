<!DOCTYPE html><!--2g5l5spmHH2whnexrXqsy-->
<html lang="en">

<head>
  <script>
    // SUPPRESS ZOMBIE ERRORS from unused React logic
    (function () {
      var originalAlert = window.alert;
      window.alert = function (msg) {
        if (msg && typeof msg === 'string' &&
          (msg.includes("Replicate module not found") || msg.includes("Something went wrong: Replicate"))) {
          console.warn("Suppressed zombie error:", msg);
          return; // Ignore this specific error
        }
        // Pass through other alerts
        if (originalAlert) originalAlert.apply(window, arguments);
      };
    })();
  </script>


  <script src="../../../js/CSInterface.js"></script>

  <meta charSet="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preload" href="./next/static/media/797e433ab948586e-s.p.dbea232f.woff2" as="font" crossorigin=""
    type="font/woff2" />
  <link rel="preload" href="./next/static/media/caa3a2e1cccd8315-s.p.853070df.woff2" as="font" crossorigin=""
    type="font/woff2" />
  <link rel="stylesheet" href="./next/static/chunks/3df583b311e7c12c.css" data-precedence="next" />
  <link rel="preload" as="script" fetchPriority="low" href="./next/static/chunks/fd5f064b2a3f9309.js" />
  <script src="./next/static/chunks/9367d18603aececf.js" async=""></script>
  <script src="./next/static/chunks/b32a0963684b9933.js" async=""></script>
  <script src="./next/static/chunks/turbopack-699cd33d4e17a12a.js" async=""></script>
  <script src="./next/static/chunks/42879de7b8087bc9.js" async=""></script>
  <script src="./next/static/chunks/cb58a204f64c760f.js" async=""></script>
  <script src="./next/static/chunks/689d6fe979ac8c7b.js" async=""></script>
  <script src="./next/static/chunks/33f7e5a25c4fcd0b.js" async=""></script>
  <meta name="next-size-adjust" content="" />
  <title>Create Next App</title>
  <meta name="description" content="Generated by create next app" />
  <link rel="icon" href="/favicon.ico?favicon.0b3bf435.ico" sizes="256x256" type="image/x-icon" />
  <script src="./next/static/chunks/a6dad97d9634a72d.js" noModule=""></script>
</head>

<body class="geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased">
  <div hidden=""><!--$--><!--/$--></div>
  <main class="min-h-screen bg-[#121212] text-white font-sans overflow-hidden flex flex-col p-5 select-none">
    <header class="mb-8">
      <div class="flex items-center gap-2 mb-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
          viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round" class="lucide lucide-music w-6 h-6 text-[#3ea6ff]" aria-hidden="true">
          <path d="M9 18V5l12-2v13"></path>
          <circle cx="6" cy="18" r="3"></circle>
          <circle cx="18" cy="16" r="3"></circle>
        </svg>
        <h1 class="text-2xl font-bold tracking-tight text-[#f0f0f0]">SonicForge</h1>
      </div>
      <p class="text-[10px] text-[#666] uppercase tracking-[0.2em] ml-8 font-medium">AI Sound Effect Generator</p>
    </header>
    <div class="flex-1 space-y-6">
      <div class="flex gap-4"><button
          class="flex-1 py-3 rounded-full font-medium text-sm transition-all flex items-center justify-center gap-2 border-2 bg-[#2d5a88] border-[#2d5a88] text-white shadow-lg shadow-blue-900/20"><svg
            xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="lucide lucide-wand-sparkles w-4 h-4" aria-hidden="true">
            <path
              d="m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72">
            </path>
            <path d="m14 7 3 3"></path>
            <path d="M5 6v4"></path>
            <path d="M19 14v4"></path>
            <path d="M10 2v2"></path>
            <path d="M7 8H3"></path>
            <path d="M21 16h-4"></path>
            <path d="M11 3H9"></path>
          </svg>Text to Sound</button><button
          class="flex-1 py-3 rounded-full font-medium text-sm transition-all flex items-center justify-center gap-2 border-2 bg-transparent border-[#333] text-[#666] hover:border-[#444] hover:text-[#888]"><svg
            xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="lucide lucide-upload w-4 h-4" aria-hidden="true">
            <path d="M12 3v12"></path>
            <path d="m17 8-5-5-5 5"></path>
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          </svg>Audio Remix</button></div>
      <div class="space-y-2"><label
          class="text-xs text-[#666] uppercase tracking-wider font-semibold ml-1">Prompt</label><textarea
          placeholder="Describe the sound or music..."
          class="w-full h-28 bg-[#1e1e1e] rounded-3xl p-4 text-sm text-[#ffffff] placeholder:text-[#888] focus:outline-none focus:ring-2 focus:ring-[#2d5a88] transition-all resize-none border border-transparent focus:border-transparent"></textarea>
      </div>
      <div class="space-y-3 pt-2">
        <div class="flex justify-between text-xs items-center px-1"><span
            class="text-[#666] font-medium">Duration</span><span class="text-[#3ea6ff] font-bold">8<!-- -->s</span>
        </div><input type="range" min="5" max="30"
          class="w-full h-2 bg-[#1e1e1e] rounded-full appearance-none cursor-pointer accent-[#3ea6ff]" value="8" />
      </div><button disabled=""
        class="w-full py-4 rounded-full bg-[#2d5a88] hover:bg-[#356a9e] active:bg-[#254b73] text-white font-bold text-base transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-xl shadow-black/20 mt-4">Generate
        Sound</button>
    </div>
  </main><!--$--><!--/$-->
  <script src="./next/static/chunks/fd5f064b2a3f9309.js" id="_R_" async=""></script>
  <script>(self.__next_f = self.__next_f || []).push([0])</script>
  <script>self.__next_f.push([1, "0:{\"P\":null,\"b\":\"2g5l5spmHH2whnexrXqsy\",\"c\":[\"\",\"\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"__PAGE__\",{}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"./next/static/chunks/3df583b311e7c12c.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"geist_a71539c9-module__T19VSG__variable geist_mono_8d43a2aa-module__8Li5zG__variable antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[\"$\",\"$L4\",null,{\"Component\":\"$5\",\"serverProvidedParams\":{\"searchParams\":{},\"params\":{},\"promises\":[\"$@6\",\"$@7\"]}}],[[\"$\",\"script\",\"script-0\",{\"src\":\"./next/static/chunks/cb58a204f64c760f.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"./next/static/chunks/689d6fe979ac8c7b.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-2\",{\"src\":\"./next/static/chunks/33f7e5a25c4fcd0b.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L8\",null,{\"children\":[\"$\",\"$9\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@a\"}]}]]}],{},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$Lb\",null,{\"children\":\"$@c\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"$9\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@e\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"S\":true}\n"])</script>
  <script>self.__next_f.push([1, "6:{}\n7:\"$0:f:0:1:1:children:0:props:children:0:props:serverProvidedParams:params\"\n"])</script>
  <script>self.__next_f.push([1, "c:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script>
  <script>self.__next_f.push([1, "10:I[27201,[\"./next/static/chunks/42879de7b8087bc9.js\"],\"IconMark\"]\ne:[[\"$\",\"title\",\"0\",{\"children\":\"Create Next App\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Generated by create next app\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico?favicon.0b3bf435.ico\",\"sizes\":\"256x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$L10\",\"3\",{}]]\na:null\n"])</script>
  <script>
      (function () {
        // --- UI Hijacking & Logic for ElevenLabs Switch ---

        const STATE = {
          isLoading: false
        };

        function initSettings() {
          if (document.getElementById('sonic-settings-btn')) return;

          // Settings Button
          var btn = document.createElement('button');
          btn.id = 'sonic-settings-btn';
          btn.innerHTML = '⚙️';
          btn.title = 'Set ElevenLabs API Key';
          Object.assign(btn.style, {
            position: 'fixed', top: '20px', right: '20px', zIndex: '9999',
            background: '#333', color: '#fff', border: '1px solid #555',
            borderRadius: '50%', width: '40px', height: '40px',
            fontSize: '20px', cursor: 'pointer', display: 'flex',
            alignItems: 'center', justifyContent: 'center', transition: 'background 0.2s'
          });
          btn.onmouseenter = function () { btn.style.background = '#444'; };
          btn.onmouseleave = function () { btn.style.background = '#333'; };

          // Status Message Element
          var status = document.createElement('div');
          status.id = 'sonic-status-msg';
          Object.assign(status.style, {
            position: 'fixed', top: '25px', right: '70px', zIndex: '9999',
            background: '#4caf50', color: '#fff', padding: '6px 12px',
            borderRadius: '20px', fontSize: '12px', fontWeight: 'bold',
            opacity: '0', pointerEvents: 'none', transition: 'opacity 0.3s'
          });
          status.innerText = 'Saved!';
          document.body.appendChild(status);

          btn.onclick = function () {
            var currentKey = localStorage.getItem('elevenlabs_api_key') || localStorage.getItem('sonic_forge_api_key') || '';
            var newKey = prompt('Enter your ElevenLabs API Key:', currentKey);
            if (newKey !== null) {
              localStorage.setItem('elevenlabs_api_key', newKey.trim());
              localStorage.setItem('sonic_forge_api_key', newKey.trim());

              status.innerText = 'Saved!';
              status.style.background = '#4caf50';
              status.style.opacity = '1';
              setTimeout(function () { status.style.opacity = '0'; }, 2000);
            }
          };
          document.body.appendChild(btn);
        }

        function showStatus(msg, type) {
          var el = document.getElementById('sonic-status-msg');
          if (!el) return;
          el.innerText = msg;
          el.style.background = type === 'error' ? '#f44336' : (type === 'loading' ? '#2196F3' : '#4caf50');
          el.style.opacity = '1';
          if (type !== 'loading') {
            setTimeout(function () { el.style.opacity = '0'; }, 3000);
          }
        }

        function addImportButton(filePath) {
          var existing = document.getElementById('sonic-import-btn');
          if (existing) existing.remove();

          var btn = document.createElement('button');
          btn.id = 'sonic-import-btn';
          btn.innerText = "Import to Timeline";
          Object.assign(btn.style, {
            display: 'block', width: '100%', padding: '12px',
            marginTop: '12px', background: '#e91e63', color: 'white',
            border: 'none', borderRadius: '8px', cursor: 'pointer',
            fontWeight: 'bold', fontSize: '14px', textTransform: 'uppercase',
            boxShadow: '0 4px 6px rgba(0,0,0,0.2)'
          });

          btn.onclick = function () {
            if (typeof CSInterface === 'undefined') {
              alert("Error: CSInterface.js not loaded. Please restart the extension.");
              return;
            }
            if (window.__adobe_cep__) {
              try {
                var csInterface = new CSInterface();
                var cleanPath = filePath.replace(/\\/g, "\\\\");
                // EvalScript to Import
                var script = "try { " +
                  "var io = new ImportOptions(File('" + cleanPath + "')); " +
                  "if (io.canImportAs(ImportAsType.FOOTAGE)) { " +
                  "  var item = app.project.importFile(io); " +
                  "  if (app.project.activeItem && app.project.activeItem instanceof CompItem) { " +
                  "    app.project.activeItem.layers.add(item); " +
                  "  } " +
                  "} " +
                  "} catch(e) { alert('ExtendScript Error: ' + e); }";
                csInterface.evalScript(script);
                showStatus("Imported!", "success");
              } catch (err) {
                alert("Import Error: " + err.message);
              }
            }
          };

          var genBtn = document.querySelector('[data-hijacked="true"]');
          if (genBtn && genBtn.parentNode) {
            genBtn.parentNode.insertBefore(btn, genBtn.nextSibling);
          }
        }

        function hijackGenerateButton() {
          var buttons = document.getElementsByTagName('button');
          var genBtn = null;

          for (var i = 0; i < buttons.length; i++) {
            if (buttons[i].innerText.includes('Generate Sound')) {
              genBtn = buttons[i];
              break;
            }
          }

          if (!genBtn) return;
          if (genBtn.dataset.hijacked === 'true') return;

          var newBtn = genBtn.cloneNode(true);
          genBtn.parentNode.replaceChild(newBtn, genBtn);
          newBtn.dataset.hijacked = 'true';
          newBtn.removeAttribute('disabled');

          var durationEl = document.querySelector('input[type="range"]');
          if (durationEl && durationEl.max < 60) {
            durationEl.max = 300;
          }

          newBtn.onclick = async function (e) {
            e.preventDefault();
            if (STATE.isLoading) return;

            var key = localStorage.getItem('elevenlabs_api_key') || localStorage.getItem('sonic_forge_api_key');
            if (!key) {
              alert("Please set your ElevenLabs API Key first (Gear Icon).");
              return;
            }

            var promptEl = document.querySelector('textarea');
            var durationEl = document.querySelector('input[type="range"]');

            var text = promptEl ? promptEl.value : "";
            var duration = durationEl ? parseFloat(durationEl.value) : 10.0;

            if (!text) {
              alert("Please enter a prompt to describe the sound/music.");
              return;
            }

            STATE.isLoading = true;
            newBtn.innerText = "Generating...";
            newBtn.style.opacity = "0.7";
            showStatus("Generating Music/SFX...", "loading");

            try {
              var resp = await fetch('https://api.elevenlabs.io/v1/sound-generation', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  'xi-api-key': key
                },
                body: JSON.stringify({
                  "text": text,
                  "duration_seconds": duration,
                  "prompt_influence": 0.3
                })
              });

              if (!resp.ok) {
                var errText = await resp.text();
                throw new Error(errText);
              }

              var blob = await resp.blob();
              var arrayBuffer = await blob.arrayBuffer();

              if (window.cep) {
                var fs = require('fs');
                var path = require('path');
                var homeDir = process.env.HOME || process.env.USERPROFILE;
                var docPath = path.join(homeDir, "Documents");
                if (!fs.existsSync(docPath)) fs.mkdirSync(docPath);

                var safePrompt = text.slice(0, 20).replace(/[^a-z0-9]/gi, '_');
                var fileName = "SonicForge_" + safePrompt + "_" + Date.now() + ".mp3";
                var savePath = path.join(docPath, fileName);

                fs.writeFileSync(savePath, Buffer.from(arrayBuffer));

                showStatus("Saved!", "success");
                addImportButton(savePath);

                var audio = new Audio(savePath);
                audio.play();

              } else {
                var audioUrl = URL.createObjectURL(blob);
                new Audio(audioUrl).play();
                alert("Generated! (Not in CEP, cannot save)");
              }

              newBtn.innerText = "Generate Sound";

            } catch (err) {
              console.error(err);
              showStatus("Error", "error");
              alert("Generation Failed: " + err.message);
              newBtn.innerText = "Generate Sound";
            } finally {
              STATE.isLoading = false;
              newBtn.style.opacity = "1";
            }
          };
        }

        function init() {
          initSettings();
          hijackGenerateButton();
        }

        if (document.readyState === 'complete') {
          init();
        } else {
          window.addEventListener('load', init);
        }
        setInterval(hijackGenerateButton, 1000);
      })();
  </script>
</body>

</html>